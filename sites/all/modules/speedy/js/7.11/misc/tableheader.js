(function($){Drupal.behaviors.tableHeader={attach:function(a,b){if(!$.support.positionFixed)return;$("table.sticky-enabled",a).once("tableheader",function(){$(this).data("drupal-tableheader",new Drupal.tableHeader(this))})}},Drupal.tableHeader=function(a){var b=this;this.originalTable=$(a),this.originalHeader=$(a).children("thead"),this.originalHeaderCells=this.originalHeader.find("> tr > th"),this.stickyTable=$('<table class="sticky-header"/>').insertBefore(this.originalTable).css({position:"fixed",top:"0px"}),this.stickyHeader=this.originalHeader.clone(!0).hide().appendTo(this.stickyTable),this.stickyHeaderCells=this.stickyHeader.find("> tr > th"),this.originalTable.addClass("sticky-table"),$(window).bind("scroll.drupal-tableheader",$.proxy(this,"eventhandlerRecalculateStickyHeader")).bind("resize.drupal-tableheader",{calculateWidth:!0},$.proxy(this,"eventhandlerRecalculateStickyHeader")).bind("drupalDisplaceAnchor.drupal-tableheader",function(){window.scrollBy(0,-b.stickyTable.outerHeight())}).bind("drupalDisplaceFocus.drupal-tableheader",function(a){b.stickyVisible&&a.clientY<b.stickyOffsetTop+b.stickyTable.outerHeight()&&a.$target.closest("sticky-header").length===0&&window.scrollBy(0,-b.stickyTable.outerHeight())}).triggerHandler("resize.drupal-tableheader"),this.stickyHeader.show()},Drupal.tableHeader.prototype.eventhandlerRecalculateStickyHeader=function(event){var self=this,calculateWidth=event.data&&event.data.calculateWidth;this.stickyOffsetTop=Drupal.settings.tableHeaderOffset?eval(Drupal.settings.tableHeaderOffset+"()"):0,this.stickyTable.css("top",this.stickyOffsetTop+"px");var viewHeight=document.documentElement.scrollHeight||document.body.scrollHeight;if(calculateWidth||this.viewHeight!==viewHeight)this.viewHeight=viewHeight,this.vPosition=this.originalTable.offset().top-4-this.stickyOffsetTop,this.hPosition=this.originalTable.offset().left,this.vLength=this.originalTable[0].clientHeight-100,calculateWidth=!0;var hScroll=document.documentElement.scrollLeft||document.body.scrollLeft,vOffset=(document.documentElement.scrollTop||document.body.scrollTop)-this.vPosition;this.stickyVisible=vOffset>0&&vOffset<this.vLength,this.stickyTable.css({left:-hScroll+this.hPosition+"px",visibility:this.stickyVisible?"visible":"hidden"}),this.stickyVisible&&(calculateWidth||!this.widthCalculated)&&(this.widthCalculated=!0,this.stickyHeaderCells.each(function(a){var b=self.originalHeaderCells.eq(a).css("width");b=="auto"&&(b=self.originalHeaderCells.get(a).clientWidth+"px"),$(this).css("width",b)}),this.stickyTable.css("width",this.originalTable.css("width")))}})(jQuery);